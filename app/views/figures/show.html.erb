

<div class="container">
  <h1><%= @move_titleize %></h1>


  <% if @dances.blank? %>
    <p>This figure does not appear in any dances yet.</p>
  <% else %>

    <ul class="nav nav-pills">
      <li class="active"><a data-toggle="tab" href="#overview">Figures</a></li>
      <li><a data-toggle="tab" href="#dances">Dances</a></li>
      <li><a data-toggle="tab" href="#with-figure">With Move</a></li>
      <li><a data-toggle="tab" href="#beside-figure">Beside Move</a></li>
    </ul>
    <div class="tab-content figure-nobullets">
      <div id="overview" class="tab-pane fade in active">
        <div class="row">
          <div class="col-xs-12">
            <h2>Overview</h2>
            <p>
              <% if @move != JSLibFigure.de_alias_move(@move) %>
                alias for <%= link_to(JSLibFigure.de_alias_move(@move),figure_path(JSLibFigure.de_alias_move(@move))) %><br>
              <% end %>
              <% if JSLibFigure.de_alias_move(@move) != JSLibFigure.teaching_name(@move) %>
                taught as <%= link_to(JSLibFigure.teaching_name(@move),figure_path(JSLibFigure.teaching_name(@move))) %> in programs<br>
              <% end %>
              formal parameters: 
              <%= JSLibFigure.formal_parameters(@move).map {|param| param['name'] }.join(', ') %>
            </p>

            <table class="table table-bordered table-condensed contra-table-nonfluid">
              <thead>
                <tr>
                  <th>Dance</th>
                  <th>Figure</th>
                </tr>
              </thead>
              <tbody>
                <% @dances.each do |dance| %>
                  <% figures = dance.figures.select {|figure| JSLibFigure.move(figure) == @move} %>
                  <% figures.each_with_index do |figure,index| %>
                    <tr>
                      <%= content_tag(:td, (figures.length > 1) && {rowspan: figures.length}) do link_to(dance.title, dance) end if 0==index %>
                      <td><%= JSLibFigure.html figure %></td>
                    </tr>
                  <% end %>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="dances" class="tab-pane fade">
        <div class="row">
          <div class="col-sm-6 col-md-4 col-lg-3">
            <h2>Appears in</h2>
            <ul>
              <% @dances.each_with_index do |dance,i| %>
                <li><%= link_to dance.title, dance %></li>
              <% end %>
            </ul>
          </div>
          <div class="col-sm-6 col-md-4 col-lg-3">
            <h2>Not in</h2>
            <ul>
              <% @dances_absent.each_with_index do |dance,i| %>
                <li><%= link_to dance.title, dance %></li>
              <% end %>
            </ul>
          </div>
        </div>
      </div>
      <div id="with-figure" class="tab-pane fade">
        <div class="row">
          <div class="col-sm-12">
            <h2>Moves Sharing a Dance</h2>
            <%= render partial: 'mdtab', object: @coappearing_mdtab %>
          </div>
        </div>
      </div>
      <div id="beside-figure" class="tab-pane fade">
        <div class="row">
          <div class="col-sm-6 col-md-4 col-lg-3">
            <h2>Moves Before</h2>
            <%= render partial: 'mdtab', object: @preceeding_mdtab %>
          </div>
          <div class="col-sm-6 col-md-4 col-lg-3">
            <h2>Moves After</h2>
            <%= render partial: 'mdtab', object: @following_mdtab %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>




